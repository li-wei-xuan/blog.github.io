---
title: 子查询
date: 2023-01-03
tags:
 - mysql
---

## 子查询定义
```
子查询指一个查询语句嵌套在另一个查询语句内部的查询

子查询可以在 SELECT、UPDATE 和 DELETE 语句中使用，而且可以进行多层嵌套。在实际开发时，子查询经常出现在 WHERE 子句中。
```

## 语法
### 单行子查询
```SQL
-- 等于
  SELECT * FROM user WHERE user_id = (SELECT user_id FROM user_point WHERE phone = '123456789')

-- 大于 / 小于
  SELECT * FROM user WHERE point > (SELECT point FROM user_point WHERE name = '张三')
  SELECT * FROM user WHERE point < (SELECT point FROM user_point WHERE name = '张三')

-- 大于等于 / 小于等于
  SELECT * FROM user WHERE point >= (SELECT point FROM user_point WHERE name = '张三')
  SELECT * FROM user WHERE point <= (SELECT point FROM user_point WHERE name = '张三')

-- 不等于
  SELECT * FROM user WHERE point != (SELECT point FROM user_point WHERE name = '张三')
  SELECT * FROM user WHERE point <> (SELECT point FROM user_point WHERE name = '张三')
```
<!--
| 方法  | 说明                                     |
| ----- | ---------------------------------------- |
| count | 统计数量，参数是要统计的字段名（可选）   |
| max   | 获取最大值，参数是要统计的字段名（必须） |
| min   | 获取最小值，参数是要统计的字段名（必须） |
| avg   | 获取平均值，参数是要统计的字段名（必须） |
| sum   | 获取总分，参数是要统计的字段名（必须）   | --> 

### 多行子查询
```SQL
-- IN 等于列表中的任意一个
  SELECT * FROM user WHERE id IN (SELECT id FROM user_point WHERE name like '%张%')
-- ALL 需要和单行比较操作符一起使用，和子查询返回的所有值比较
  SELECT * FROM user WHERE point <= ALL(SELECT point FROM user_point WHERE name = '张三')
-- ANY 需要和单行比较操作符一起使用，和子查询返回的某一个值比较(別名：SOME)
  SELECT * FROM user WHERE point <= ANY(SELECT point FROM user_point WHERE name = '张三')
```

### 链表子查询
```SQL
  SELECT * FROM user a 
  LEFT JOIN (SELECT user_id,sum(point) FROM lucky_user GROUP by user_id) b 
  ON a.id = b.user_id
```
