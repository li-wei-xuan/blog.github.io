---
title: 数据扁平化
date: 2022-10-18
tags:
 - JavaScript
 - interview
categories:
 - JavaScript
 - interview
---
<!-- https://segmentfault.com/a/1190000038414123 -->
### Array.prototype.flat()
```js
// es6 新增数组方法。Array.prototype.flat()
// 缺点：需要计算数组的维度
var arr = [1, [2, 21, [22, 221, [2211, 2212]]], [3, [31, 32, [33, 331]]], 4, { 'name': 'jack' }]
console.log(arr.flat(4))   // [1,2,21,22,221,2211,2212,3,31,32,33,331,4,{'name': 'jack'}]
// 使用 Infinity 作为深度，展开任意深度的嵌套数组
console.log(arr.flat(Infinity))  // [1,2,21,22,221,2211,2212,3,31,32,33,331,4,{'name': 'jack'}]
```

### 数组字符串化
```js
// 缺点：数组内对象无法转换
var arr = [1, [2, 21, [22, 221, [2211, 2212]]], [3, [31, 32, [33, 331]]], 4, { 'name': 'jack' }]
arr += '';
arr = arr.split(',');
console.log(arr) // ['1', '2', '21', '22', '221', '2211', '2212', '3', '31', '32', '33', '331', '4', '[object Object]']
```

### 递归
```js
var arr = [1, [2, 21, [22, 221, [2211, 2212]]], [3, [31, 32, [33, 331]]], 4, { 'name': 'jack' }]
  function reduceDimension(arr) {
    let result = [];
    let toArr = function (arr) {
      arr.forEach(function (item) {
        // instanceof 就是判断一个实例是否属于某种类型
        item instanceof Array ? toArr(item) : result.push(item)
      })
    }
    toArr(arr);
    return result;
  }
console.log(reduceDimension(arr)) //[1,2,21,22,221,2211,2212,3,31,32,33,331,4,{'name': 'jack'}]
```

### reduce + concat + 递归
```js
var arr = [1, [2, 21, [22, 221, [2211, 2212]]], [3, [31, 32, [33, 331]]], 4, { 'name': 'jack' }]
  function reduceDimension(arr) {
    return arr.reduce(function (prev, next) {
      return Array.isArray(next) ? prev.concat(reduceDimension(next)) : prev.concat(next)
    }, [])
  }
console.log(reduceDimension(arr)) //[1,2,21,22,221,2211,2212,3,31,32,33,331,4,{'name': 'jack'}]
```