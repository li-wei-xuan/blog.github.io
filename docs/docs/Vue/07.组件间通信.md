---
title: 组件间通信
date: 2023-03-13
tags:
 - vue
categories:
 - vue
---

```
组件间通信的方法
	props
	自定义事件
	全局事件总线
	消息订阅与发布

组件间通信方法不止以上几种，以上几种推荐使用全局事件总线
```



### props

```js
props
   用于组件接受参数
  // 简单接受
    props:['name','msg','age']

  // 指定接受类型
    props:{'name':String,'msg':String,'age':Number}

  // 类型限制+默认值的指定+必要性的限制
  props:{
    name:{
      type:String, //name的类型是字符串
      required:true, //name是必要的
    },
    age:{
      type:Number,
      default:99 //默认值
    },
    msg:{
      type:String,
      required:true
    }
  }   
      
props 主要用于父子间通信
```

### 自定义事件

```js
// 父组件
方法一：
	<Student ref="student" @click.native="show"/>
    
  mounted() {
    this.$refs.$on('getStudentName', this.getStudentName) //绑定自定义事件
  }

ref: vue中对dom元素进行操作,在生命周期中 mounted 中能获取到
  
方法二：
	<Student @getStudentName="getStudentName"/>

公共部分：
  method: {
    getStudentName(name,...params) {
      console.log(name,params)
    }
  }
  

// 子组件
this.$emit('getStudentName',666,888,900)//触发Student组件实例身上的getStudentName事件
this.$off('getStudentName') //解绑一个自定义事件
this.$destroy() //销毁了当前Student组件的实例，销毁后所有Student实例的自定义事件全都不奏效。

自定义事件 主要用于父子间通信
```

### 全局事件总线

```js
// 在main.js中
beforeCreate() {
  Vue.prototype.$bus = this //安装全局事件总线
}

this.$bus.$on("checkAllTodo", this.checkAllTodo); // 绑定事件
this.$bus.$emit("checkAllTodo", 222,234,); // 触发事件
this.$bus.$off("checkAllTodo"); //解绑事件

全局事件总线 用于全局组件间通信
```

### 消息订阅与发布

```js
安装插件 npm i pubsub-js

// 在页面中引入
import pubsub from 'pubsub-js'

mounted() {
  this.PubId = pubsub.subscribe("deleteTodo", this.deleteTodo); // 订阅
}
  
beforeDestroy() {
  pubsub.unsubscribe(this.PubId); // 取消订阅
}
  
pubsub.publish("deleteTodo", val.id); // 执行

消息订阅与发布 用于全局组件间通信
```

