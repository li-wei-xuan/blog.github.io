---
title: 节流和防抖
date: 2022-10-09
tags:
 - interview
categories:
 - interview
---
## 节流和防抖的定义和区别
### 定义
```
防抖：指触发事件后，在 n 秒后函数才会执行，如果在 n 秒内又触发了事件，则会重新计算函数执行时间
节流：指连续触发事件，但是在 n 秒中只执行一次函数
```
### 区别
```
防抖：多次触发，只执行最后一次
节流：规定时间内，只触发一次
相同点：
  都可以通过使用 setTimeout 实现
  目的都是，降低回调执行频率。节省计算资源
不同点：
  函数防抖，在一段连续操作结束后，处理回调，利用clearTimeout和 setTimeout实现。
  函数节流，在一段连续操作中，每一段时间只执行一次，频率较高的事件中使用来提高性能
  函数防抖关注一定时间连续触发的事件，只在最后执行一次，而函数节流一段时间内只执行一次
```

## 防抖和节流解决什么问题

```
在进行resize、scroll、keyup、keydown、mousedown、mousemove等事件操作时，
如果事件处理函数调用的频率无限制，会加重浏览器的负担，容易导致页面卡顿等影响用户的体验；
这时就可以通过debounce(防抖)和throttle(节流)函数来限制事件处理函数的调用频率，提升用户的体验，同时又不影响实际的效果。
```

## 代码实现
```js
// 节流
const throttle = (fn, delay = 1500) => {
    let lastTime = 0;
    return function (...args) {
        const nowTime = Date.now();
        if (nowTime - lastTime > delay) {
            fn.apply(this, args);
            lastTime = nowTime;
        }
    };
};

// 防抖
const debounce = (fn, delay = 500) => {
    let timer = null;
    return function (...args) {
        //清除上一次延时器
        if (timer) {
            clearTimeout(timer);
            timer = null;
        }
        //重新设置新的延时器
        timer = setTimeout(() => {
            fn.apply(this, args);
        }, delay);
    };
};
```

## 防抖和节流的应用场景
### 防抖
```
1. 登录、发短信等按钮避免用户点击太快，以致于发送了多次请求，需要防抖。
2. 调整浏览器窗口大小时，resize 次数过于频繁，造成计算过多。
3. 文本编辑器实时保存，当无任何更改操作一秒后进行保存。
4. DOM 元素的拖拽功能实现。
5. 计算鼠标移动的距离。
6. Canvas 模拟画板功能。
7. 搜索联想。
```

### 节流
```
1. scroll 事件，每隔一秒计算一次位置信息等。
2. 浏览器播放事件，每个一秒计算一次进度信息等。
3. input框实时搜索并发送请求展示下拉列表，每隔一秒发送一次请求 (也可做防抖)。
```