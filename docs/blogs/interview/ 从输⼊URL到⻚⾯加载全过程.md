---
title:  从输⼊URL到⻚⾯加载全过程
date: 2024-03-01
tags:
 - interview
categories:
 - interview
---

从输入URL到页面加载的全过程涉及多个步骤，包括网络协议、服务器处理、浏览器渲染等环节。以下是整个过程的详细步骤：  

1、**URL解析**：用户在浏览器地址栏输入URL后，浏览器会解析URL以确定要访问的协议（如HTTP或HTTPS）、服务器的域名以及具体的文件路径。  

2、**域名解析（DNS解析）**：浏览器会查询DNS（域名系统）来将域名转换成服务器的IP地址。如果DNS记录已缓存，将直接使用该记录。  

3、**建立连接**：

- 如果是HTTP协议，浏览器将通过TCP三次握手建立与服务器的连接。
- 如果是HTTPS协议，则还会进行TLS握手过程，以确保数据加密传输。  

4、**发送HTTP请求**：浏览器构建HTTP请求报文，包括请求行（如GET /index.html HTTP/1.1）、请求头（包含用户代理、接受的内容类型等信息）和请求体（如果有的话，通常用于POST请求）。  

5、**服务器处理请求**：服务器接收到HTTP请求后，会根据请求类型进行处理。这可能包括查询数据库、执行服务器端脚本或查找请求的文件。  

6、**服务器响应**：服务器处理完请求后，会发回一个HTTP响应，其中包含响应状态码（如200表示成功），响应头（包含内容类型、缓存控制等信息）和响应体（请求的资源内容）。  

7、**浏览器处理服务器响应**：  

- 浏览器首先检查HTTP状态码，如果是重定向（如状态码为301或302），则会发起新的请求到Location头指定的URL。
- 接着处理响应头的信息，设置缓存、查看内容类型等。
- 最后，浏览器开始处理响应体中的数据，如果是HTML，则开始构建DOM树。

8、**构建DOM树**：浏览器解析HTML文档，创建DOM树。HTML中的标签被转换为DOM节点。  

9、**CSSOM树构建**：浏览器解析CSS文件和`<style>`标签内的样式，构建CSSOM树（CSS对象模型）。  

10、**JavaScript加载与执行**：浏览器按顺序下载并执行HTML中引用的JavaScript代码。JavaScript可操作DOM和CSSOM，但在执行脚本期间可能会阻塞DOM构建。  

11、**渲染树构建**：浏览器通过结合DOM树和CSSOM树来创建渲染树，渲染树只包含需要显示的节点和样式信息。  

12、**布局（Reflow）**：一旦渲染树构建完成，浏览器开始计算每个节点的确切位置和大小，这个过程称为布局或回流。  

13、**绘制（Painting）**：布局完成后，浏览器会在屏幕上绘制内容，包括文本、颜色、图像等。  

14、**合成（Compositing）**：某些情况下，页面的部分内容会在独立的图层上绘制，然后浏览器会将这些图层合成到一起，形成最终的屏幕图像。    

在整个过程中，如果页面中还有其它的资源需要加载（如图片、字体文件、JavaScript脚本、CSS样式表等），浏览器会重复进行部分步骤来获取这些资源，这可能导致额外的网络请求和页面渲染。  

请注意，这只是一个简化的过程概述，实际过程更为复杂，涉及浏览器的预解析优化、异步JavaScript和CSS的处理、资源缓存策略、网络条件和服务器性能等因素。
